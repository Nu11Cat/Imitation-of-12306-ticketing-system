jdk17

springboot3对jdk要求17

spring cloud Alibaba 2022.0.0支持springboot 3

相应升级其他



springboot3：AOT新特性







CDN分流

分布式缓存加快访问+常见问题

两层验证码：纯前端 + 后端，解决瞬时高峰

限流

令牌

分布式锁

异步削峰

排队机制

分布式事务



难点

动态库存(区段问题)

选座功能

线上线下售票

不停刷票

超卖问题



处理忙碌问题？

硬件堆积

gemfire：分布式内存数据库

算法：模型逻辑

削峰：验证码；分时段；排队；限流，异步；



模型设计：

把每个小段都记录票数，如果A-B卖了，那么A-C的数目也-1.

用0/1表示座位购买



核心功能：

会员：注册/登录、乘客管理、余票查询、车票购买、我的车票

管理：基础车次、每日车次、会员管理、车票管理



功能模块：

网关：路由转发、登录校验

会员：会员、乘客、已购车票

业务：车次、余票

跑批：管理定时任务、界面启停

web：会员相关界面

admin：管理员相关

热点接口的单独模块：如余票查询



数据库表：

会员模块：

· 会员表：手机号

· 乘客表：会员ID，姓名，身份证，旅客类型

· 车票表：会员ID，乘客ID，乘客姓名，日期，车次信息，座位信息

业务模块：

· 车站表：站名，站名拼音

· 车次表：车次编号，车次类型，始发站，出发时间，终点站，到站时间

· 到站表：车次编号，站名，进站时间，出站时间，停站时长，里程

· 车箱表：车次编号，箱号，座位类型，座位数，排数，列数

· 座位表：车次编号，箱号，排号，列号

· 每日车次表：日期，基础车次信息

· 每日到站表：日期，基础到站信息

· 每日车箱表：日期，基础车箱信息

· 每日座位表：日期，基础座位信息，销售详情

· 每日余票表：日期，车次编号，出发站，出发时间，到达站，到站时间，各种座位的余票信息

其它：

· quartz相关表：定时任务

· seata相关表：分布式事务





持续秒杀高并发：

前端：CDN、页面静态化、倒计时&Loading、验证码削峰

后端：微服务服务拆分、负载均衡、限流降级、缓存、令牌、异步处理

数据库：分库、读写分离、分表、冗余设计(反范式，空间换时间)、分布式数据库

其他：分时段秒杀、弹性扩容、候补+排队



